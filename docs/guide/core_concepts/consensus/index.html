<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.4">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Material+Icons"><title data-react-helmet="true">Consensus | IOTA Smart Contract Protocol</title><meta data-react-helmet="true" property="og:url" content="https://iscp.docs.iota.org/wasp/docs/guide/core_concepts/consensus/"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Consensus | IOTA Smart Contract Protocol"><meta data-react-helmet="true" name="description" content="ISCP Consensus"><meta data-react-helmet="true" property="og:description" content="ISCP Consensus"><meta data-react-helmet="true" name="keywords" content="ISCP,Smart Contracts,Consensus"><meta data-react-helmet="true" property="og:image" content="https://iscp.docs.iota.org/wasp/img/logo/WASP_logo_dark.png"><meta data-react-helmet="true" name="twitter:image" content="https://iscp.docs.iota.org/wasp/img/logo/WASP_logo_dark.png"><link data-react-helmet="true" rel="shortcut icon" href="/wasp/img/logo/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://iscp.docs.iota.org/wasp/docs/guide/core_concepts/consensus/"><link data-react-helmet="true" rel="alternate" href="https://iscp.docs.iota.org/wasp/docs/guide/core_concepts/consensus/" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://iscp.docs.iota.org/wasp/docs/guide/core_concepts/consensus/" hreflang="x-default"><link rel="stylesheet" href="/wasp/assets/css/styles.7fc9fac0.css">
<link rel="preload" href="/wasp/assets/js/runtime~main.32764b3a.js" as="script">
<link rel="preload" href="/wasp/assets/js/main.89321dfb.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/wasp/"><img src="/wasp/img/logo/WASP_logo_dark.png" alt="IOTA" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/wasp/img/logo/WASP_logo_dark.png" alt="IOTA" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">ISCP</b></a><a class="navbar__item navbar__link navbar__link--active" href="/wasp/docs/overview/">Documentation</a></div><div class="navbar__items navbar__items--right"><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button" title="Scroll to top"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/wasp/docs/overview/">Overview</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Core Concepts</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/wasp/docs/guide/core_concepts/smart-contracts/">Smart Contracts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/wasp/docs/guide/core_concepts/iscp/">ISCP</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/wasp/docs/guide/core_concepts/iscp-architecture/">ISCP Architecture</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/wasp/docs/guide/core_concepts/validators/">Committees and Validators</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/wasp/docs/guide/core_concepts/consensus/">Consensus</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/wasp/docs/guide/core_concepts/states/">State, Transitions and State Anchoring</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/wasp/docs/guide/core_concepts/smart-contract-anatomy/">Anatomy of a Smart Contract</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/wasp/docs/guide/core_concepts/sandbox/">Sandbox Interface</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Core Contracts</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Accounts</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Interacting With Smart Contracts</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Types of VMs/Languages</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Solo</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">ISCP Chains and Nodes</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Rust/WASM</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">EVM</a></li><li class="menu__list-item"><a class="menu__link" href="/wasp/docs/contribute/">Contribute</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Old</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="markdown"><header><h1 class="h1Heading_27L5">Consensus</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="consensus-on-computations"></a>Consensus on computations<a class="hash-link" href="#consensus-on-computations" title="Direct link to heading">#</a></h2><p>Even if all committee nodes are honest (i.e. they have no malicious intent), there are factors which may make each node see things differently. This can lead to different inputs to the same program on different nodes and, consequently, to different results.</p><p>There are several possible reasons for such an apparently non-deterministic outcome.</p><p>Each committee node has its own access to the UTXO ledger, i.e. committee nodes are usually connected to different IOTA nodes. The reason for this is to not make access to the UTXO ledger a single point of failure, i.e. we also want access to the Tangle to be distributed. This may often lead to a slightly different perception of some aspects of the ledger, for example of the token balance in a particular address. Also, each node has its own local clock and those clocks may be slightly skewed, so there isnâ€™t an objective time for nodes.</p><p>The requests (UTXOs) may reach Wasp nodes in an arbitrary order and with arbitrary delays (even if these are usually close to the network latency).</p><p>Before starting calculations, nodes are required to have consensus on the following:</p><ul><li>The current state of the chain i.e. on the state output</li><li>Timestamp to be used for the next state transaction</li><li>Ordered batch of requests to be processed</li><li>Address where node fees for processing the request must be sent (if enabled)</li><li>Mana pledge targets</li></ul><p>In order to achieve a bigger throughput, the committee picks requests from the on-ledger backlog and processes requests in batches, not one by one. This means the committee has to have a consensus on the batch of the requests and the order of the requests in the batch. After at least a quorum of committee nodes have a consensus on the above, honest committee members will always produce identical results of calculations.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="proof-of-consensus"></a>Proof of consensus<a class="hash-link" href="#proof-of-consensus" title="Direct link to heading">#</a></h2><p>Suppose a quorum of committee nodes has reached consensus on inputs and produced identical results, these being the block of state updates and the anchor transaction.</p><p>The anchor transaction contains chain state transition, the AliasOutput and token transfers, so it must be signed.</p><p><strong>It is only possible to produce valid signatures of inputs of the anchor transaction by the quorum</strong> of nodes. In this case, a confirmed anchor transaction becomes a cryptographical <strong>proof of consensus</strong> in the committee.  </p><p>To archive this, ISCP uses <strong>BLS threshold signatures in combination with polynomial (Shamir) secret sharing</strong> to identify the address controlling the chain state. In order for the secret keys to be distributed across the chain validators, a DKG (Distributed Key Generation) procedure is executed when starting a chain (using the Rabin-Gennaro algorithm).</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="the-consensus-algorithm"></a>The Consensus Algorithm<a class="hash-link" href="#the-consensus-algorithm" title="Direct link to heading">#</a></h2><p>The committee is of fixed size, thus we use a Byzantine Fault Tolerant (BFT) Algorithm, which guarantees consistency and byzantine fault tolerance if less than â…“ of nodes are malicious.</p><p>As a basis for the ISCP consensus, the Asynchronous Common Subset (ACS) part of the HoneyBadgerBFT algorithm is used, with the exception of how the proposals are combined.</p><p>The rest of the consensus algorithm is built on top of the ACS. Each node supplies to the ACS its batch proposal which indicates a set of Request IDs, a timestamp, consensus and access mana pledge addresses, fee destination and a partial signature for generating non-forgeable entropy. Upon termination of the ACS, each honest node gets the same set of such proposals and aggregates them into the final batch in a deterministic way.</p><p>It is ensured that all honest nodes have the same input for the VM. After running the selected batch, the VM results are then collectively signed using the threshold signature. The signed transaction can be published by any node at this point. In order to minimize the load on the IOTA network, the nodes calculate a delay for posting the transaction to the network based on a deterministic permutation of the nodes relative to the local perception of time.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>A more in-depth explanation of the topics described in this page can be found on the <a href="https://github.com/iotaledger/wasp/raw/master/documentation/ISCP%20architecture%20description%20v3.pdf" target="_blank" rel="noopener noreferrer">architecture document</a></p></div></div></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/iotaledger/chronicle.rs/tree/main/docs/docs/guide/core_concepts/consensus.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_3DPF"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/wasp/docs/guide/core_concepts/validators/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Validators</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/wasp/docs/guide/core_concepts/states/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">State, Transitions and State Anchoring Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#consensus-on-computations" class="table-of-contents__link">Consensus on computations</a></li><li><a href="#proof-of-consensus" class="table-of-contents__link">Proof of consensus</a></li><li><a href="#the-consensus-algorithm" class="table-of-contents__link">The Consensus Algorithm</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Documentation</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/wasp/docs/overview/">Overview</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 IOTA Foundation, Built with Docusaurus.</div></div></div></footer></div>
<script src="/wasp/assets/js/runtime~main.32764b3a.js"></script>
<script src="/wasp/assets/js/main.89321dfb.js"></script>
</body>
</html>